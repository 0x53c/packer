variant: fcos
version: 1.4.0
passwd:
  user:
    - name: core
      ssh_authorized_keys:
        - <TODO-ADD_PUBLIC_KEYS>
      groups:
        - sudo
        - docker
storage:
  files: 
    - path: /etc/hostname
      mode: 0644
      contents:
        inline: helios-coreos
    - path: /etc/sysctl.d/20-silience-audit.conf
      mode: 0644
      contents:
        inline: |
          overly
          br_netfilter
    -  path: /etc/sysctl.d/k8s.config
       mode: 0644
       contents:
          inline: |
            net.bridge.bridge-nf-call-iptables = 1
            net.bridge.bridge-nf-call-ip6tables = 1
            net.ipv4.ip_forward = 1
systemd:
  units:
    - name: docker.service
      enabled: true
    - name: prepare-k8s.service
      enabled: true
      contents: |
        [Unit]
        Description=Prepare system for Kubernetes
        After=network-online.target
        Wants=network-online.target

        [Service]
        Type=Onset
        ExecStart=/bin/sh -c "sysctl --system"
        RemainAfterExist=true

        [Install]
        WantedBy=multi-user.target